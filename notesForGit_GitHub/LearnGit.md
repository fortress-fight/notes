# LearnGit

参考
[廖雪峰-git](http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/)

## 1. Git 基本介绍

Git -- 分布式版本控制系统

### 1.1 集中式和分布式

集中式的版本控制系统比较典型的是 SVN；

- 集中式：
    1. 集中式的版本控制系统，版本库是集中存放在中央服务器中的，在开发的前从中央服务器中取得最新的版本，而在开发后在将文件推送给重要服务器；
    2. 集中式的缺点：必须联网才能工作，受到网速的限制

- 分布式
    1. 分布式的版本控制系统，是以个人工作的电脑作为一个完整的版本库，在写作的时候，将各自的修改推送给对方，就可以看到对方的修改了，但是使用分布式的版本控制系统的时候，很少会在两个人之间的电脑上推送版本库的修改；而是使用一个充当中央服务器的电脑，来方便交换大家的修改；
    2. 分布式的优势：多个完整的版本库并存使得系统的安全性要高很多；并且具有强大的分支管理

### 1.2 Git 的安装

目前 Git 官网已提供 window 使用的 Git 可以直接安装使用；安装软件方式就不做细说；

附上：
[廖雪峰 git 安装地址](http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/00137396287703354d8c6c01c904c7d9ff056ae23da865a000)

## 2 Git 的基本使用

设置贡献者(全局)

```txt
`git config --global user.name [用户名]`
`git config --global user.emall [邮箱名]`
`git config --list`
```

### 2.1 创建版本库

版本库又叫做仓库：repository, 在这个仓库下面的文件都可以被 Git 管理起来，git可以追踪每一个文件的修改、删除；从而可以实现版本还原；

创建版本库：

- 在 GitHub 上创建一个版本库，然后使用git工具进入需要保存文件的路径，然后通过 `git clone + 地址` 的方式下载到本地；

- 本地创建：
    找到一个合适的目录
    1. `mkdir learnGit` -- 创建一个 learnGit 文件夹
    2. `cd learnGit` -- 进入创建的文件夹
    3. `pwd` -- 输出当前路径
    4. `git init` -- 创建 git 仓库，这时会在当前目录下面创建一个 .git 目录(配置文件-config，就在这个目录下)，这个目录就是 git 用于跟踪管理版本库的；

- 注：
    1. 最好不要使用中文路径；
    2. 使用 tab 可以自动补全路径；
    3. 使用 `ls` 可以查看当前文件夹下的子文件，`ls -ah` 可以查看被隐藏的文件；
    4. git 只能跟踪文本文件（最好是UTF-8的编码格式）的改动；

### 2.2 添加文件

在创建好的文件夹中，添加一个文件（比如：git.txt）;文件内容如下:

```txt
这是创建的一个文本，用于测试git
Git is free software.
```

1. 可以通过 `git add git.txt` 来将文件添加到仓库；
2. 通过 `git commit -m "注释"` 可以将文件提交到仓库

- 注：
    1. 使用 `cd > git.txt` 可以创建文件--git.txt;
    2. 输入 git.txt 就可以直接打开；
    3. 使用 `dir` 可以查看子文件；
    4. 同样可以通过使用 tab 来进行补全；

- 补上这一段命令在 git 中的表现

![git-1](./img/git-1.png);

### 2.2 仓库状态

目前我们仓库中已经存在一个 git.txt 文件，现在我们对这个文件进行修改；

```txt
这是创建的一个文本，用于测试git
Git is good software.
文件的第一个修改（free => good）
```

1. 使用 `git status` 查看状态；
2. 可以使用 `git diff` 查看具体的修改部分；
3. `git add git.txt`
4. 使用 `git status` 查看状态
    文件名为红色，表示文件还没有进行管理处在工作区
    文件名为绿色表示在暂存区
5. `git commit -m "change one"`
6. `git status`

- 注：
    1. `git status` 可以让我们时刻掌握仓库的当前状态；
    2. `git diff` 可以查看文件的difference的地方；
    3. 不要使用 win 下的记事本去编辑文件，会导致各种问题；

- 补上这一段命令在 git 中的表现

![git-2](./img/git-2.png);
![git-2](./img/git-2-1.png);

- 注：
    1. 其中红色的文字是指修改前的文字
    2. 绿色的文字后面跟着M是指修改后的文字
    3. 绿色的文字后面没有标示的表示新增的文字
    4. 可能不同的 git 工具下表现不同，以实际表现为准

### 2.3 版本回退

我们尝试再一次修改文件

```txt
这是创建的一个文本，用于测试git
Git is good software.
文件的第一个修改（free => good）

Git is a distributed version control system
测试版本回退的时，添加的文字；
```

1. 使用 `git log` 查看版本：(16进制版本号、版本注释、操作者、时间等)
    可以查看到共有三个版本：
    1. this is a test for git
    2. change one
    3. 测试版本回退

2. 进行版本回退
    1. 在 Git 中，HEAD表示当前版本，通过 `HEAD^` 表示上一个版本，`^` 可以连续使用，不过也可以通过 `~` 的方式直接指定到上某个版本，例如：上一百可以使用 `HEAD~100`;
    2. 现在我们把当前版本回退到上一个版本 -- change one
    3. 使用 `git rest` 命令，可以进行版本回退，回退到上一个 `git rest --hard HEAD`;这是文件就已经回到了 change one 时的状态
    4. `git log` 可以看到 `测试版本回退` 这个版本已经不存在了
    5. 如果想要回退的指定版本可以使用 `git reset --hard 版本号`，例如 我们要回退到 `测试版本回退` 这个版本，首先找到这个版本的版本号，然后输入
    `git reset --hard ca75b26b336a0e` (版本号无需输全)，这时就已经还原到 `测试版本回退` 的版本状态了
    6. 如果已经找不到了版本号，可以使用 `git reflog` 查看当前仓库的每一次命令（commit 和 reset 等），在起始位置就是版本号

- 注：
    1. 如果使用 git log 发现文字太多不易观察可以使用 `git log --pretty=oneline`
    2. 使用 `cat 文件名` 可以直接输出文件内容
    3. git 是通过切换指针来修改当前指向的版本，通过修改本地文件，所以这个速度是十分快速的
    4. 如果日志很长，可以通过 q 退出；

- 补上这一段命令在 git 中的表现

![git-3](./img/git-3-1.png);
![git-3](./img/git-3-2.png);

- 注：其中 commit 就是指提交的版本号

### 2.4 工作区和暂存区

Git 和 其他版本公职系统和 SVN 的一个不同之处的就是有暂存区的概念

- 工作区
    简单的说就是电脑中能够看到的目录

- 版本库
    工作区有一个隐藏目录 `.git` ,这个目录就是 git 的版本库；
    在版本库中：
    1. 叫做 stage 的暂存区；
    2. git 为我们自动创建的第一个分支 master
    3. 指向 master 的一个指针 HEAD
    [git版本库图解](./img/版本库.jpg)

- 暂存区
     暂存区是版本库中重要的一部分；
     `git add` 就是将文件提交到暂存区
     `git commit` 就是将暂存区的所欲内容提交到当前分支（默认就是 master 分支）

- 操作：
    1. 继续修改 git.txt 并且 再添加一个文件 LICENSE；
    2. 使用 `git status` 会告诉你，有一个文件修改，一个文件还未提交；
    3. 使用 `git add .` 将两次修改提交到暂存区
    4. 使用 `git status` 再次查看状态
    5. 使用 `git commit` 将暂存区的内容一次性的提交到版本区；
    6. 使用 `git status` 查看状态

- 注：一旦提交到版本区以后，同时你的工作区没有修改，那么工作区就是干净的，并且暂存区是空的；

- 补上这一段命令在 git 中的表现

![git-4](./img/git-4.png);

- 注： `[master +0 ~1 -0 !]` master 代表分支，第一个数字代表工作区，第二个数字代表暂存区，第三个数字版本区；绿色，代表已存在的，红色代表修改；+ 代表新增 - 代表删除

### 2.4 管理修改

Git跟踪并管理的是修改，而非文件。

1. 修改 git.txt，在后加上：

    ```txt
        Git and change
        学习管理修改时添加
    ```
2. `git add`
3. `git status`
4. 再次修改 git.txt
5. `git commit`
6. `git status`
7. `git diff HEAD -- git.txt`

- 注：commit 只会提交暂存区的内容

- 补上这一段命令在 git 中的表现

![git-5](./img/git-5.png);

- 注：
    查看已经暂存起来的文件(staged)和上次提交时的快照之间(HEAD)的差异
    比较暂存区和版本区：
    `git diff --cached`
    `git diff --staged`
    比较 版本1 版本2 的差异
    `git diff 版本1 版本2`
    比较两个分支的差异
    `git diff 分支`
    显示简单的差异
    `git diff --stat`

#### 2.4.1 撤销更改

当你在修改文件以后，突然发现修改错了，要撤销这次修改，但是修改的地方太多了，一点一点的撤销十分的麻烦，这时就可以使用 `git checkout -- <file>` 的方式撤销这次修改；

1. 继续修改 git.txt 添加
    ```txt
        this is a error code
        这句话需要被撤销修改
    ```
2. `git status`
    这里会有提示
3. `git checkout -- git.txt`
    这样文件就会撤销掉这一次的修改

如果，你不仅仅修改了，还将这一次修改提交到了暂存区，可以使用：

1. 继续修改 git.txt 添加
    ```txt
        this is a error code2
        这句话需要被撤销修改2
    ```
2. `git add git.txt`
3. `git status`
    同样会有提示
4. `git reset HEAD git.txt`
    这一个命令就可以将暂存区的修改撤销掉，重新放到工作区
5. `git status`
6. `git checkout -- git.txt`
    成功撤销修改

再如果你已经把暂存区的文件提交到了版本库中，可以使用 `git reset --hard <版本号>` 的方式进行回退

- 补上这一段命令在 git 中的表现

![git-6](./img/git-6.png);

- 注：
    如果 commit 的时候，注释写错了，可以使用
    `git commit --amend` 进行修改

#### 2.4.2 删除文件

1. 添加一个新的文件(test.txt)到 git 并且提交，
2. 这时我们将这个文件删除
    - 直接本地删除
    - 使用 rm 命令删除
    这时将会提示工作区和版本区不同了
3. `git status`
    查看提示，那些文件被删除了
4. 如果需要在版本区也删除
    - `git rm <file>`
    - `git commit`
5. 如果并不是需要删除，而是误删的话可以通过 `git checkout -- test.txt`进行恢复

- 补上这一段命令在 git 中的表现

![git-7](./img/git-7.png);

- 注：
    `git rm -f 文件名` 可以强制删除（暂存和本地）
    `git rm --cached` 可以强制删除暂存区的文件
